<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wpeng2005.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Docker1.Docker概述Docker的思想来源于集装箱！ JRE –多个应用 （端口冲突） –原来都是交叉的！ 隔离：Docker核心思想！打包装箱！每个箱子是互相隔离的 1.1Docker能做什么 容器化技术：容器化技术不是模拟的一个完整的操作系统  比较Docker和虚拟机技术的不同：  传统虚拟机，虚拟出一条硬件，运行一个完整的操作系统，然后在系统上安装和运行软件 容器内的应用直接运">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker">
<meta property="og:url" content="https://wpeng2005.github.io/2024/07/01/Docker/index.html">
<meta property="og:site_name" content="PengBlog">
<meta property="og:description" content="Docker1.Docker概述Docker的思想来源于集装箱！ JRE –多个应用 （端口冲突） –原来都是交叉的！ 隔离：Docker核心思想！打包装箱！每个箱子是互相隔离的 1.1Docker能做什么 容器化技术：容器化技术不是模拟的一个完整的操作系统  比较Docker和虚拟机技术的不同：  传统虚拟机，虚拟出一条硬件，运行一个完整的操作系统，然后在系统上安装和运行软件 容器内的应用直接运">
<meta property="og:locale">
<meta property="og:image" content="https://www.freeimg.cn/i/2024/05/08/663b99472e6d7.jpg">
<meta property="og:image" content="https://www.freeimg.cn/i/2024/05/09/663c3667ac2ad.jpg">
<meta property="og:image" content="https://www.freeimg.cn/i/2024/05/11/663f920212692.jpg">
<meta property="og:image" content="https://www.freeimg.cn/i/2024/05/13/6641b5ba591ae.jpg">
<meta property="og:image" content="https://www.freeimg.cn/i/2024/05/14/6642d5b191c27.png">
<meta property="og:image" content="https://www.freeimg.cn/i/2024/05/13/66422773b10ff.jpg">
<meta property="og:image" content="https://www.freeimg.cn/i/2024/05/14/66433726dd7a8.jpg">
<meta property="og:image" content="https://www.freeimg.cn/i/2024/05/14/664339d6b8a72.png">
<meta property="og:image" content="https://www.freeimg.cn/i/2024/05/14/66434f85cbc40.png">
<meta property="article:published_time" content="2024-07-01T04:17:34.328Z">
<meta property="article:modified_time" content="2024-07-01T04:16:03.940Z">
<meta property="article:author" content="Peng">
<meta property="article:tag" content="Docker">
<meta property="article:tag" content="DeployTools">
<meta property="article:tag" content="DevelopTools">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.freeimg.cn/i/2024/05/08/663b99472e6d7.jpg">

<link rel="canonical" href="https://wpeng2005.github.io/2024/07/01/Docker/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"><style>
#needsharebutton-postbottom {
  cursor: pointer;
  height: 26px;
  margin-top: 10px;
  position: relative;
}
#needsharebutton-postbottom .btn {
  border: 1px solid $btn-default-border-color;
  border-radius: 3px;
  display: initial;
  padding: 1px 4px;
}
</style>
  <title>Docker | PengBlog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">PengBlog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://wpeng2005.github.io/2024/07/01/Docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/myavatar.jpg">
      <meta itemprop="name" content="Peng">
      <meta itemprop="description" content="<font color="#FFFFFF">Done is better than perfect</font>">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PengBlog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Docker
        </h1>

        <div class="post-meta">
        
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-07-01 12:17:34 / 修改时间：12:16:03" itemprop="dateCreated datePublished" datetime="2024-07-01T12:17:34+08:00">2024-07-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>32k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>29 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><h2 id="1-Docker概述"><a href="#1-Docker概述" class="headerlink" title="1.Docker概述"></a>1.Docker概述</h2><p>Docker的思想来源于集装箱！</p>
<p>JRE –多个应用 （端口冲突） –原来都是交叉的！</p>
<p>隔离：Docker核心思想！打包装箱！每个箱子是互相隔离的</p>
<h3 id="1-1Docker能做什么"><a href="#1-1Docker能做什么" class="headerlink" title="1.1Docker能做什么"></a>1.1Docker能做什么</h3><blockquote>
<p>容器化技术：容器化技术不是模拟的一个完整的操作系统</p>
</blockquote>
<p>比较Docker和虚拟机技术的不同：</p>
<ul>
<li>传统虚拟机，虚拟出一条硬件，运行一个完整的操作系统，然后在系统上安装和运行软件</li>
<li>容器内的应用直接运行在宿主机的内容，容器时是没有自己内核的</li>
<li>每个容器内是互相隔离的，每个容器内都有一个属于自己的文件系统，互不影响</li>
</ul>
<span id="more"></span>

<blockquote>
<p>DevOps(开发，运维)</p>
</blockquote>
<p><strong>更快速地交付和部署</strong></p>
<p>Docker：打包镜像，发布测试，一键运行</p>
<p><strong>更便捷的升级和扩缩容</strong></p>
<p>使用了 Docker之后，我们部署应用就和搭积木一样</p>
<p>项目打包为一个镜像，扩展服务器A！服务器B</p>
<p><strong>更简单的系统运维</strong></p>
<p>在容器化之后，我们的开发，测试环境都是高度一致的</p>
<p><strong>更高效的计算资源利用</strong></p>
<p>Docker是内核级别的虚拟化，可以在一个物理机上可以运行很多的容器实例！服务器的性能可以被压榨</p>
<p>到极致。</p>
<h3 id="1-2Docker基本组成"><a href="#1-2Docker基本组成" class="headerlink" title="1.2Docker基本组成"></a>1.2Docker基本组成</h3><p><strong>镜像（images）</strong>：</p>
<p>docker镜像就好比一个模板，可以通过这个模板来创建容器服务，</p>
<p>例如：tomcat镜像&#x3D;&#x3D;&#x3D;&gt;run &#x3D;&#x3D;&gt;tomcat01容器(提供服务器)</p>
<p>通过这个镜像可以创建多个容器（最终服务运行或者项目运行就是在容器中）</p>
<p><strong>容器（container）</strong>：</p>
<p>Docker利用容器技术，独立运行一个或者一组应用，通过镜像来创建的</p>
<p>容器可以启动，停止，删除等基本命令</p>
<p>目前可以把这个容器理解为一个简易的Linux系统，</p>
<p><strong>仓库（repository）</strong>：</p>
<p>仓库就是存放镜像的地方</p>
<p>仓库分为公有仓库和私有仓库</p>
<h3 id="1-3回顾Docker-helloworld流程"><a href="#1-3回顾Docker-helloworld流程" class="headerlink" title="1.3回顾Docker helloworld流程"></a>1.3回顾Docker helloworld流程</h3><p>1.run的运行流程图</p>
<p><img src="https://www.freeimg.cn/i/2024/05/08/663b99472e6d7.jpg" alt="https://www.freeimg.cn/i/2024/05/08/663b99472e6d7.jpg"></p>
<h3 id="1-4底层原理"><a href="#1-4底层原理" class="headerlink" title="1.4底层原理"></a>1.4底层原理</h3><p><strong>Docker是怎么工作的？</strong></p>
<p>Docker是一个Client-Server结构的系统，Docker的守护进程运行在主机上，通过Socket从客户端访问</p>
<p>DockerServer接收到Docker-Client的指令，就会执行这个命令</p>
<p><img src="https://www.freeimg.cn/i/2024/05/09/663c3667ac2ad.jpg" alt="https://www.freeimg.cn/i/2024/05/09/663c3667ac2ad.jpg"></p>
<h2 id="2-Docker的基本命令"><a href="#2-Docker的基本命令" class="headerlink" title="2.Docker的基本命令"></a>2.Docker的基本命令</h2><h3 id="2-1帮助命令"><a href="#2-1帮助命令" class="headerlink" title="2.1帮助命令"></a>2.1帮助命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version #查看版本信息</span><br><span class="line">docker info    #查看docker的系统信息，包括镜像和容器的数量</span><br><span class="line">docker  命令  --help  #帮助命令</span><br></pre></td></tr></table></figure>

<h3 id="2-2-镜像命令"><a href="#2-2-镜像命令" class="headerlink" title="2.2 镜像命令"></a>2.2 镜像命令</h3><p><strong>docker images</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng /]# docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">hello-world   latest    d2c94e258dcb   12 months ago   13.3kB</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">解释</span></span><br><span class="line">REPOSITORY  镜像的仓库源</span><br><span class="line">TAG 		镜像的标签</span><br><span class="line">IMAGE ID	镜像的id</span><br><span class="line">CREATED		镜像创建的时间</span><br><span class="line">SIZE		镜像的大小</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">可选项</span></span><br><span class="line">-a, --all             	#列出所有镜像</span><br><span class="line">      --digests         Show digests</span><br><span class="line">  -f, --filter filter   Filter output based on conditions provided</span><br><span class="line">      --format string   Format output using a custom template:</span><br><span class="line">                        &#x27;table&#x27;:            Print output in table format with column headers (default)</span><br><span class="line">                        &#x27;table TEMPLATE&#x27;:   Print output in table format using the given Go template</span><br><span class="line">                        &#x27;json&#x27;:             Print in JSON format</span><br><span class="line">                        &#x27;TEMPLATE&#x27;:         Print output using the given Go template.</span><br><span class="line">                        Refer to https://docs.docker.com/go/formatting/ for more information about formatting output with templates</span><br><span class="line">      --no-trunc        Don&#x27;t truncate output</span><br><span class="line">  -q, --quiet           #只显示镜像的id</span><br></pre></td></tr></table></figure>



<p><strong>docker search   搜索镜像</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng ~]# docker search mysql</span><br><span class="line">NAME                            DESCRIPTION                                     STARS     OFFICIAL</span><br><span class="line">mariadb                         MariaDB Server is a high performing open sou…   5722      [OK]</span><br><span class="line">mysql                           MySQL is a widely used, open-source relation…   15008     [OK]</span><br><span class="line">percona                         Percona Server is a fork of the MySQL relati…   627       [OK]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">可选项</span>   </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">通过收藏来过滤   --filter=StARS=3000  搜索3000以上收藏的</span></span><br></pre></td></tr></table></figure>



<p><strong>docker pull  下载镜像</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">下载镜像   docker pull 镜像名[:tag]</span></span><br><span class="line">[root@wpeng ~]# docker pull mysql</span><br><span class="line">Using default tag: latest   #如果不写tag，默认就是latest</span><br><span class="line">latest: Pulling from library/mysql</span><br><span class="line">0f6737e7f918: Pull complete   #分层下载   docker image的核心  联合文件系统</span><br><span class="line">43ed19546d51: Pull complete </span><br><span class="line">501aa8e883de: Pull complete </span><br><span class="line">530c0b888a0f: Pull complete </span><br><span class="line">4670b7e1bbfd: Pull complete </span><br><span class="line">33d50b789abe: Pull complete </span><br><span class="line">7cd9fbae13f7: Pull complete </span><br><span class="line">34b7592f6de1: Pull complete </span><br><span class="line">6795b8ab791a: Pull complete </span><br><span class="line">09cffac37cee: Pull complete </span><br><span class="line">Digest: sha256:e4054c2973be8766370769312786404fbb4557fb591d9ad37beb2d00a2c574a6  #签名</span><br><span class="line">Status: Downloaded newer image for mysql:latest</span><br><span class="line">docker.io/library/mysql:latest	#真实地址</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">以上命令等价于下方命令</span></span><br><span class="line">docker pull mysql</span><br><span class="line">docker pull docker.io/library/mysql:latest</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">指定版本下载</span></span><br><span class="line">docker pull mysql:8.0.20</span><br></pre></td></tr></table></figure>



<p><strong>docker rmi  删除镜像</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng ~]#docker rmi -f 镜像id #删除指定的镜像</span><br><span class="line">[root@wpeng ~]#docker rmi -f 镜像id 镜像id 镜像id 镜像id#删除指定的镜像</span><br><span class="line">[root@wpeng ~]#docker rmi -f $(docker images -aq) #删除全部的镜像</span><br></pre></td></tr></table></figure>



<h3 id="2-3-容器命令"><a href="#2-3-容器命令" class="headerlink" title="2.3 容器命令"></a>2.3 容器命令</h3><p><strong>说明：我们有了镜像才可以创建容器  下一个alibaba cloud linux3镜像测试学习</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull alibaba-cloud-linux-3-registry.cn-hangzhou.cr.aliyuncs.com/alinux3/alinux3:220901.1</span><br></pre></td></tr></table></figure>

<p>上述是下载杭州节点的镜像</p>
<p><strong>新建容器并启动</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">docker run [可选参数] image</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">参数说明</span></span><br><span class="line">--name=&quot;Name&quot;  容器名字   tomcat01  tomcat02  起不同的名字用来区别不同的容器</span><br><span class="line">-d    		   后台方式运行</span><br><span class="line">-p			   指定容器的端口  -p  8080:8080   -p 主机端口:容器端口(常用的)   -p 容器端口</span><br><span class="line">-P			   随机指定端口</span><br><span class="line">-it 		   使用交互方式运行，进入容器查看内容</span><br><span class="line"></span><br><span class="line">[root@wpeng ~]# docker run -it 镜像名或者镜像id /bin/bash</span><br><span class="line"></span><br><span class="line">bash-4.4# ls  查看容器内的alibabalinux</span><br><span class="line">bin  boot  dev	etc  home  lib	lib64  media  mnt  opt	proc  root  run  sbin  srv  sys  tmp  usr  var</span><br></pre></td></tr></table></figure>

<p><strong>列出所有运行中的容器</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">docker ps</span>  </span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">列出当前正在运行的容器</span></span><br><span class="line">-a	#列出当前正在运行的容器+历史运行过的容器</span><br><span class="line">-n=?	#显示最近创建的容器  ？是数字  n=1就是显示最近一个创建的容器</span><br><span class="line">-q #只显示容器的编号</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@wpeng /]# docker ps        列出正在运行的容器，这里没有容器在运行，所以没有查处结果</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line">[root@wpeng /]# docker ps -a	 加一个-a参数，列出现在以及历史运行的容器</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND       CREATED         STATUS                          PORTS     NAMES</span><br><span class="line">6800a5514ec0   c54f2e68b09f   &quot;/bin/bash&quot;   4 minutes ago   Exited (0) About a minute ago             sharp_lovelace</span><br><span class="line">77307f9c5e0b   hello-world    &quot;/hello&quot;      25 hours ago    Exited (0) 25 hours ago                   adoring_rubin</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>退出容器</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exit  #直接容器停止并退出</span><br><span class="line">ctrl +P +Q  #容器不停止退出</span><br></pre></td></tr></table></figure>

<p><strong>删除容器</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器id					#删除指定的容器，不能删除正在运行的容器，如果要强制删除 rm -f</span><br><span class="line">docker rm -f  $(docker ps -aq)   #删除所有的容器</span><br><span class="line">docker ps -a -q|xargs docker rm  #删除所有的容器</span><br></pre></td></tr></table></figure>

<p><strong>启动和停止容器</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器id		#启动容器</span><br><span class="line">docker restart 容器id		#重启容器</span><br><span class="line">docker stop  容器id		#停止当前正在运行的容器</span><br><span class="line">docker kill  容器id		#强制停止当前容器</span><br></pre></td></tr></table></figure>

<h3 id="2-4常用其他命令"><a href="#2-4常用其他命令" class="headerlink" title="2.4常用其他命令"></a>2.4常用其他命令</h3><p><strong>后台启动容器</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker run -d 镜像名或者镜像id</span><br><span class="line">root@wpeng ~]# docker run -d c54f2e68b09f</span><br><span class="line">f589d68fae5ef55b40a0cb27cafb767069e941bf1b046cda87a8a23f3e41f308</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">出现了问题，发现镜像停止了</span></span><br><span class="line">[root@wpeng ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">常见的坑：docker 容器使用后台运行，就必须要有一个前台进程，docker发现没有应用，就会自动停止</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">例如，docker启动nginx，容器启动后，发现自己没有提供服务，就会立刻停止，就是没有程序了</span></span><br></pre></td></tr></table></figure>

<p><strong>查看日志</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker logs  -tf --tail number 容器id #显示number条的日志</span><br><span class="line">docker logs -tf  容器id     #显示所有日志</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">显示日志</span></span><br><span class="line">-tf   #显示日志   </span><br><span class="line">		-t:timestamps 表示在输出的日志中包含时间戳</span><br><span class="line">		-f：意味着持续跟进（follow）日志输出</span><br></pre></td></tr></table></figure>

<p><strong>查看容器中进程信息</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker top 容器id</span><br><span class="line"></span><br><span class="line">[root@wpeng ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND       CREATED       STATUS       PORTS     NAMES</span><br><span class="line">b049032b93eb   c54f2e68b09f   &quot;/bin/bash&quot;   4 hours ago   Up 4 hours             vigilant_spence</span><br><span class="line">[root@wpeng ~]# docker top b049032b93eb</span><br><span class="line">UID             PID                 PPID                C                   STIME               TTY                 TIME                CMD</span><br><span class="line">root                60523               60502               0                   12:49               pts/0               00:00:00            /bin/bash</span><br></pre></td></tr></table></figure>

<p><strong>查看镜像的元数据</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><span class="line">docker inspect 容器id</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">测试</span></span><br><span class="line">[root@wpeng ~]# docker inspect b049032b93eb</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;b049032b93ebf228dabc3f842ee475b9705fbd9a352a10052353faab52a101a8&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2024-05-10T04:49:41.711491571Z&quot;,</span><br><span class="line">        &quot;Path&quot;: &quot;/bin/bash&quot;,</span><br><span class="line">        &quot;Args&quot;: [],</span><br><span class="line">        &quot;State&quot;: &#123;</span><br><span class="line">            &quot;Status&quot;: &quot;running&quot;,</span><br><span class="line">            &quot;Running&quot;: true,</span><br><span class="line">            &quot;Paused&quot;: false,</span><br><span class="line">            &quot;Restarting&quot;: false,</span><br><span class="line">            &quot;OOMKilled&quot;: false,</span><br><span class="line">            &quot;Dead&quot;: false,</span><br><span class="line">            &quot;Pid&quot;: 60523,</span><br><span class="line">            &quot;ExitCode&quot;: 0,</span><br><span class="line">            &quot;Error&quot;: &quot;&quot;,</span><br><span class="line">            &quot;StartedAt&quot;: &quot;2024-05-10T04:49:41.915405566Z&quot;,</span><br><span class="line">            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Image&quot;: &quot;sha256:c54f2e68b09f57d742dee837edd20ca37b9fd052f8d1456b2b0777c0046528d0&quot;,</span><br><span class="line">        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/b049032b93ebf228dabc3f842ee475b9705fbd9a352a10052353faab52a101a8/resolv.conf&quot;,</span><br><span class="line">        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/b049032b93ebf228dabc3f842ee475b9705fbd9a352a10052353faab52a101a8/hostname&quot;,</span><br><span class="line">        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/b049032b93ebf228dabc3f842ee475b9705fbd9a352a10052353faab52a101a8/hosts&quot;,</span><br><span class="line">        &quot;LogPath&quot;: &quot;/var/lib/docker/containers/b049032b93ebf228dabc3f842ee475b9705fbd9a352a10052353faab52a101a8/b049032b93ebf228dabc3f842ee475b9705fbd9a352a10052353faab52a101a8-json.log&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;/vigilant_spence&quot;,</span><br><span class="line">        &quot;RestartCount&quot;: 0,</span><br><span class="line">        &quot;Driver&quot;: &quot;overlay2&quot;,</span><br><span class="line">        &quot;Platform&quot;: &quot;linux&quot;,</span><br><span class="line">        &quot;MountLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ProcessLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;AppArmorProfile&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ExecIDs&quot;: null,</span><br><span class="line">        &quot;HostConfig&quot;: &#123;</span><br><span class="line">            &quot;Binds&quot;: null,</span><br><span class="line">            &quot;ContainerIDFile&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LogConfig&quot;: &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;json-file&quot;,</span><br><span class="line">                &quot;Config&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;NetworkMode&quot;: &quot;bridge&quot;,</span><br><span class="line">            &quot;PortBindings&quot;: &#123;&#125;,</span><br><span class="line">            &quot;RestartPolicy&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;no&quot;,</span><br><span class="line">                &quot;MaximumRetryCount&quot;: 0</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;AutoRemove&quot;: false,</span><br><span class="line">            &quot;VolumeDriver&quot;: &quot;&quot;,</span><br><span class="line">            &quot;VolumesFrom&quot;: null,</span><br><span class="line">            &quot;ConsoleSize&quot;: [</span><br><span class="line">                41,</span><br><span class="line">                187</span><br><span class="line">            ],</span><br><span class="line">            &quot;CapAdd&quot;: null,</span><br><span class="line">            &quot;CapDrop&quot;: null,</span><br><span class="line">            &quot;CgroupnsMode&quot;: &quot;host&quot;,</span><br><span class="line">            &quot;Dns&quot;: [],</span><br><span class="line">            &quot;DnsOptions&quot;: [],</span><br><span class="line">            &quot;DnsSearch&quot;: [],</span><br><span class="line">            &quot;ExtraHosts&quot;: null,</span><br><span class="line">            &quot;GroupAdd&quot;: null,</span><br><span class="line">            &quot;IpcMode&quot;: &quot;private&quot;,</span><br><span class="line">            &quot;Cgroup&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Links&quot;: null,</span><br><span class="line">            &quot;OomScoreAdj&quot;: 0,</span><br><span class="line">            &quot;PidMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Privileged&quot;: false,</span><br><span class="line">            &quot;PublishAllPorts&quot;: false,</span><br><span class="line">            &quot;ReadonlyRootfs&quot;: false,</span><br><span class="line">            &quot;SecurityOpt&quot;: null,</span><br><span class="line">            &quot;UTSMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;UsernsMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;ShmSize&quot;: 67108864,</span><br><span class="line">            &quot;Runtime&quot;: &quot;runc&quot;,</span><br><span class="line">            &quot;Isolation&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpuShares&quot;: 0,</span><br><span class="line">            &quot;Memory&quot;: 0,</span><br><span class="line">            &quot;NanoCpus&quot;: 0,</span><br><span class="line">            &quot;CgroupParent&quot;: &quot;&quot;,</span><br><span class="line">            &quot;BlkioWeight&quot;: 0,</span><br><span class="line">            &quot;BlkioWeightDevice&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadBps&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceWriteBps&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadIOps&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceWriteIOps&quot;: [],</span><br><span class="line">            &quot;CpuPeriod&quot;: 0,</span><br><span class="line">            &quot;CpuQuota&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimePeriod&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimeRuntime&quot;: 0,</span><br><span class="line">            &quot;CpusetCpus&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpusetMems&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Devices&quot;: [],</span><br><span class="line">            &quot;DeviceCgroupRules&quot;: null,</span><br><span class="line">            &quot;DeviceRequests&quot;: null,</span><br><span class="line">            &quot;MemoryReservation&quot;: 0,</span><br><span class="line">            &quot;MemorySwap&quot;: 0,</span><br><span class="line">            &quot;MemorySwappiness&quot;: null,</span><br><span class="line">            &quot;OomKillDisable&quot;: false,</span><br><span class="line">            &quot;PidsLimit&quot;: null,</span><br><span class="line">            &quot;Ulimits&quot;: [],</span><br><span class="line">            &quot;CpuCount&quot;: 0,</span><br><span class="line">            &quot;CpuPercent&quot;: 0,</span><br><span class="line">            &quot;IOMaximumIOps&quot;: 0,</span><br><span class="line">            &quot;IOMaximumBandwidth&quot;: 0,</span><br><span class="line">            &quot;MaskedPaths&quot;: [</span><br><span class="line">                &quot;/proc/asound&quot;,</span><br><span class="line">                &quot;/proc/acpi&quot;,</span><br><span class="line">                &quot;/proc/kcore&quot;,</span><br><span class="line">                &quot;/proc/keys&quot;,</span><br><span class="line">                &quot;/proc/latency_stats&quot;,</span><br><span class="line">                &quot;/proc/timer_list&quot;,</span><br><span class="line">                &quot;/proc/timer_stats&quot;,</span><br><span class="line">                &quot;/proc/sched_debug&quot;,</span><br><span class="line">                &quot;/proc/scsi&quot;,</span><br><span class="line">                &quot;/sys/firmware&quot;,</span><br><span class="line">                &quot;/sys/devices/virtual/powercap&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ReadonlyPaths&quot;: [</span><br><span class="line">                &quot;/proc/bus&quot;,</span><br><span class="line">                &quot;/proc/fs&quot;,</span><br><span class="line">                &quot;/proc/irq&quot;,</span><br><span class="line">                &quot;/proc/sys&quot;,</span><br><span class="line">                &quot;/proc/sysrq-trigger&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;GraphDriver&quot;: &#123;</span><br><span class="line">            &quot;Data&quot;: &#123;</span><br><span class="line">                &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/9bb0667c3640a03ae8bbb2d698bc030fd5e9a5027d48c0fa48f42bf607472496-init/diff:/var/lib/docker/overlay2/4fabcb33a99857d5f701a9d733a0407faef4f760993cf19c5cca603c16dc27f5/diff&quot;,</span><br><span class="line">                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/9bb0667c3640a03ae8bbb2d698bc030fd5e9a5027d48c0fa48f42bf607472496/merged&quot;,</span><br><span class="line">                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/9bb0667c3640a03ae8bbb2d698bc030fd5e9a5027d48c0fa48f42bf607472496/diff&quot;,</span><br><span class="line">                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/9bb0667c3640a03ae8bbb2d698bc030fd5e9a5027d48c0fa48f42bf607472496/work&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Name&quot;: &quot;overlay2&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Mounts&quot;: [],</span><br><span class="line">        &quot;Config&quot;: &#123;</span><br><span class="line">            &quot;Hostname&quot;: &quot;b049032b93eb&quot;,</span><br><span class="line">            &quot;Domainname&quot;: &quot;&quot;,</span><br><span class="line">            &quot;User&quot;: &quot;&quot;,</span><br><span class="line">            &quot;AttachStdin&quot;: true,</span><br><span class="line">            &quot;AttachStdout&quot;: true,</span><br><span class="line">            &quot;AttachStderr&quot;: true,</span><br><span class="line">            &quot;Tty&quot;: true,</span><br><span class="line">            &quot;OpenStdin&quot;: true,</span><br><span class="line">            &quot;StdinOnce&quot;: true,</span><br><span class="line">            &quot;Env&quot;: [</span><br><span class="line">                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Cmd&quot;: [</span><br><span class="line">                &quot;/bin/bash&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Image&quot;: &quot;c54f2e68b09f&quot;,</span><br><span class="line">            &quot;Volumes&quot;: null,</span><br><span class="line">            &quot;WorkingDir&quot;: &quot;/&quot;,</span><br><span class="line">            &quot;Entrypoint&quot;: null,</span><br><span class="line">            &quot;OnBuild&quot;: null,</span><br><span class="line">            &quot;Labels&quot;: &#123;</span><br><span class="line">                &quot;org.label-schema.build-date&quot;: &quot;20220830&quot;,</span><br><span class="line">                &quot;org.label-schema.license&quot;: &quot;GPLv2&quot;,</span><br><span class="line">                &quot;org.label-schema.name&quot;: &quot;Alinux3 Base Image&quot;,</span><br><span class="line">                &quot;org.label-schema.schema-version&quot;: &quot;1.0&quot;,</span><br><span class="line">                &quot;org.label-schema.vendor&quot;: &quot;Alibaba Cloud&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;NetworkSettings&quot;: &#123;</span><br><span class="line">            &quot;Bridge&quot;: &quot;&quot;,</span><br><span class="line">            &quot;SandboxID&quot;: &quot;5093b0c24d349da1366a160ccf8a6b34453e48241c3739973897cd53eaffbaf7&quot;,</span><br><span class="line">            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/5093b0c24d34&quot;,</span><br><span class="line">            &quot;Ports&quot;: &#123;&#125;,</span><br><span class="line">            &quot;HairpinMode&quot;: false,</span><br><span class="line">            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LinkLocalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;SecondaryIPAddresses&quot;: null,</span><br><span class="line">            &quot;SecondaryIPv6Addresses&quot;: null,</span><br><span class="line">            &quot;EndpointID&quot;: &quot;3ba3f966c5fe8dffcc94466187ac59bf8367236a889abc542f412647c4e29b6d&quot;,</span><br><span class="line">            &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">            &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">            &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">            &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">            &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">            &quot;Networks&quot;: &#123;</span><br><span class="line">                &quot;bridge&quot;: &#123;</span><br><span class="line">                    &quot;IPAMConfig&quot;: null,</span><br><span class="line">                    &quot;Links&quot;: null,</span><br><span class="line">                    &quot;Aliases&quot;: null,</span><br><span class="line">                    &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">                    &quot;NetworkID&quot;: &quot;4888153fb4139c358ffdff11975f7acf918721ae5725a8f06e6687a53668279e&quot;,</span><br><span class="line">                    &quot;EndpointID&quot;: &quot;3ba3f966c5fe8dffcc94466187ac59bf8367236a889abc542f412647c4e29b6d&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">                    &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">                    &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">                    &quot;DriverOpts&quot;: null,</span><br><span class="line">                    &quot;DNSNames&quot;: null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p><strong>进入当前正在运行的容器</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">我们通常容器都是使用后台方式进行的，需要进入容器，需要修改一些配置</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">命令</span> </span><br><span class="line">docker exec -it  容器id  /bin/bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">方式二</span></span><br><span class="line">docker attach 容器id</span><br><span class="line">正在执行当前的代码</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">二者的区别</span></span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">docker <span class="built_in">exec</span>  进入容器后开启一个新的终端，可以在里面操作</span></span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">docker attach 进入容器正在执行的终端，不会启动新的进程</span></span><br></pre></td></tr></table></figure>

<p><strong>从容器内拷贝文件到主机上</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">docker cp 容器id:容器内路径  目的主机路径</span><br><span class="line"></span><br><span class="line">[root@wpeng home]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND       CREATED          STATUS          PORTS     NAMES</span><br><span class="line">52b9662ad370   c54f2e68b09f   &quot;/bin/bash&quot;   52 minutes ago   Up 52 minutes             elated_khayyam</span><br><span class="line">[root@wpeng home]# docker attach 52b9662ad370</span><br><span class="line">bash-4.4# cd /home</span><br><span class="line">bash-4.4# ls</span><br><span class="line">bash-4.4# touch test.java</span><br><span class="line">bash-4.4# ls</span><br><span class="line">test.java</span><br><span class="line">bash-4.4# read escape sequence</span><br><span class="line">[root@wpeng home]# docker cp 52b9662ad370:/home/test.java /home</span><br><span class="line">Successfully copied 1.54kB to /home</span><br><span class="line">[root@wpeng home]# ls</span><br><span class="line">Mytest  test.java  wpeng</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">拷贝是一个手动过程  未来我们使用-v卷的技术，可以实现打通主机与容器  例如主机下的/home目录和容器内的/home目录同步</span>    </span><br></pre></td></tr></table></figure>

<h2 id="3-作业练习"><a href="#3-作业练习" class="headerlink" title="3.作业练习"></a>3.作业练习</h2><blockquote>
<p>Docker安装nginx</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1.搜索镜像  docker search 镜像名字</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2.下载镜像  docker pull 镜像名字</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-d 后台运行 --name nginx01  起别名为nginx01  -p 3344:80  主机端口，容器端口 内部端口是80，但是外网访问的是3344端口</span></span><br><span class="line">[root@wpeng /]# docker run -d --name nginx01 -p 3344:80 nginx</span><br><span class="line">29d82b8d3586f8e8831756410d90ef5ba31561460790da6b3bc9b80d0ddb706a</span><br><span class="line">[root@wpeng /]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND                  CREATED             STATUS             PORTS                                   NAMES</span><br><span class="line">29d82b8d3586   nginx          &quot;/docker-entrypoint.…&quot;   8 seconds ago       Up 7 seconds       0.0.0.0:3344-&gt;80/tcp, :::3344-&gt;80/tcp   nginx01</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Docker安装tomcat</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">官方使用</span>  </span><br><span class="line">docker run -it --rm tomcat:9.0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">我们之前的启动都是后台，停止了容器之后，容器还是可以查到   docker run -it --<span class="built_in">rm</span> 一般用来测试，用完即删除</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">下载再启动</span></span><br><span class="line">docker pull tomcat</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动运行</span></span><br><span class="line">[root@wpeng ~]# docker run -d --name tomcat01 tomcat</span><br><span class="line">abe42510023f787c38cfe38bc5ed99ae88e78baa479be84223e9aef21e177af8</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Docker部署es+kibana</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">es  暴露的端口很多</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">es  十分的耗内存</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">es 的数据一般需要放置到安全目录！挂载</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动 elasticsearch</span></span><br><span class="line">docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; elasticsearch:版本号</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">--net somenetwork 网络配置</span></span><br></pre></td></tr></table></figure>

<h2 id="4-可视化"><a href="#4-可视化" class="headerlink" title="4.可视化"></a>4.可视化</h2><h3 id="4-1portainer"><a href="#4-1portainer" class="headerlink" title="4.1portainer"></a><strong>4.1portainer</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查询当前有哪些Portainer镜像</span></span><br><span class="line">docker search portainer</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载镜像</span></span><br><span class="line">docker pull portainer/portainer</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行portainerUI图形界面</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-d后台运行 --name 命名 -p 端口映射(需要确认端口号是开放的) -v挂载(后面博客详说)</span></span><br><span class="line">docker run -d --name portainerUI -p 9000:9000 -v /var/run/docker.sock:/var/run/docker.sock -restart=always --privileged=true portainer/portainer</span><br></pre></td></tr></table></figure>

<p>什么是portainer？</p>
<p>Docker图形化界面管理工具！提供一个后台面板供我们操作</p>
<p><strong>Rancher</strong></p>
<h2 id="5-Docker镜像讲解"><a href="#5-Docker镜像讲解" class="headerlink" title="5.Docker镜像讲解"></a>5.Docker镜像讲解</h2><h3 id="5-1镜像是什么"><a href="#5-1镜像是什么" class="headerlink" title="5.1镜像是什么"></a><strong>5.1镜像是什么</strong></h3><p>镜像是一种轻量级，可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需的所有内容，包括代码，运行时，库，环境变量和配置文件</p>
<p>所有的应用，直接打包成一个docker镜像，就可以直接跑起来</p>
<p>如何得到镜像呢</p>
<ul>
<li>从远程仓库下载</li>
<li>别人拷贝给你</li>
<li>自己制作一个镜像 docker file</li>
</ul>
<h3 id="5-2Docker镜像加载原理"><a href="#5-2Docker镜像加载原理" class="headerlink" title="5.2Docker镜像加载原理"></a>5.2Docker镜像加载原理</h3><blockquote>
<p>UnionFs （联合文件系统）</p>
</blockquote>
<p>我们下载的时候看到一层层的下载就是这个。</p>
<p>UnionFs（联合文件系统）：Union文件系统（UnionFs）是一种分层、轻量级并且高性能的文件系统，他支</p>
<p>持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下（</p>
<p>unite several directories into a single virtual filesystem)。Union文件系统是</p>
<p>Docker镜像的基础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应</p>
<p>用镜像。</p>
<p><strong>特性</strong>：一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系</p>
<p>统叠加起来，这样最终的文件系统会包含所有底层的文件和目录。</p>
<h3 id="5-3分层理解"><a href="#5-3分层理解" class="headerlink" title="5.3分层理解"></a>5.3分层理解</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_46618592/article/details/126555359">https://blog.csdn.net/weixin_46618592/article/details/126555359</a></p>
<p><img src="https://www.freeimg.cn/i/2024/05/11/663f920212692.jpg" alt="https://www.freeimg.cn/i/2024/05/11/663f920212692.jpg"></p>
<h3 id="5-4-commit镜像"><a href="#5-4-commit镜像" class="headerlink" title="5.4  commit镜像"></a>5.4  commit镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker commit  提交容器成为一个新的副本</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">命令和git原理相似</span></span><br><span class="line">docker commit -m=&quot;提交的描述信息&quot; -a=&quot;作者&quot; 容器id  目标镜像名:[tag]</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p>实战测试</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动一个默认的tomcat</span></span><br><span class="line">docker exec -it 5a2a89b5dd88 /bin/bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">发现这个默认的tomcat是没有webapps应用，  镜像的原因，官方的镜像默认webapps下面是没有文件的</span></span><br><span class="line">root@5a2a89b5dd88:/usr/local/tomcat# cd webapps</span><br><span class="line">root@5a2a89b5dd88:/usr/local/tomcat/webapps# ls</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">我自己拷贝进去了基本的文件</span></span><br><span class="line">root@5a2a89b5dd88:/usr/local/tomcat# cd webapps.dist/</span><br><span class="line">root@5a2a89b5dd88:/usr/local/tomcat/webapps.dist# ls</span><br><span class="line">docs  examples  host-manager  manager  ROOT</span><br><span class="line"></span><br><span class="line">root@5a2a89b5dd88:/usr/local/tomcat# cp -r  webapps.dist/* webapps</span><br><span class="line">root@5a2a89b5dd88:/usr/local/tomcat# cd webapps</span><br><span class="line">root@5a2a89b5dd88:/usr/local/tomcat/webapps# ls</span><br><span class="line">docs  examples  host-manager  manager  ROOT</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>添加镜像</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng /]docker ps        </span><br><span class="line">CONTAINER ID   IMAGE                 COMMAND             CREATED          STATUS          PORTS                                                           NAMES</span><br><span class="line">5a2a89b5dd88   tomcat                &quot;catalina.sh run&quot;   12 minutes ago   Up 12 minutes   8080/tcp                                                        unruffled_visvesvaraya</span><br><span class="line">af1186a6d300   portainer/portainer   &quot;/portainer&quot;        40 hours ago     Up 40 hours     8000/tcp, 9443/tcp, 0.0.0.0:9000-&gt;9000/tcp, :::9000-&gt;9000/tcp   portainerUI</span><br><span class="line"></span><br><span class="line">[root@wpeng /]# docker commit  -a=&quot;wpeng&quot; -m=&quot;add webapps application&quot; 5a2a89b5dd88 tomcat02:1.0</span><br><span class="line">sha256:e337f0c3d17aacf7cc88a4ab64c31f8574703310f73c59f36d441f8bd69fd30d</span><br><span class="line">[root@wpeng /]# docker images</span><br><span class="line">REPOSITORY                                                                   TAG        IMAGE ID       CREATED         SIZE</span><br><span class="line">tomcat02                                                                     1.0        e337f0c3d17a   5 seconds ago   460MB</span><br><span class="line">nginx                                                                        latest     1d668e06f1e5   9 days ago      188MB</span><br><span class="line">tomcat                                                                       latest     fca42eb4b550   10 days ago     455MB</span><br><span class="line">mysql                                                                        latest     f3df03e3cfc9   11 days ago     585MB</span><br><span class="line">hello-world                                                                  latest     d2c94e258dcb   12 months ago   13.3kB</span><br><span class="line">portainer/portainer                                                          latest     5f11582196a4   17 months ago   287MB</span><br><span class="line">alibaba-cloud-linux-3-registry.cn-hangzhou.cr.aliyuncs.com/alinux3/alinux3   220901.1   c54f2e68b09f   20 months ago   162MB</span><br><span class="line">elasticsearch                                                                7.6.2      f29a1ee41030   4 years ago     791MB</span><br><span class="line"><span class="meta prompt_">  #</span><span class="language-bash">tomcat02就是我们自己修改过的镜像，以后使用我们自己的镜像</span></span><br></pre></td></tr></table></figure>



<h2 id="6-容器数据卷"><a href="#6-容器数据卷" class="headerlink" title="6.容器数据卷"></a>6.容器数据卷</h2><h3 id="6-1什么是容器数据卷"><a href="#6-1什么是容器数据卷" class="headerlink" title="6.1什么是容器数据卷"></a>6.1什么是容器数据卷</h3><p><strong>docker理念回顾</strong>、</p>
<p>将应用和环境打包成一个镜像</p>
<p>数据？如果数据都在容器中，那么我们容器删除，数据就会丢失！&#x3D;&#x3D;需求：数据可以持久化&#x3D;&#x3D;</p>
<p>Mysql，容器删除了数据就会丢失！&#x3D;&#x3D;需求：Mysql数据可以存储在本地&#x3D;&#x3D;</p>
<p>容器之间可以有一个数据共享技术！Docker容器中产生的数据，同步到本地</p>
<p>这就是卷技术!   目录的挂载，将我们容器内的目录，挂载到Linux上面</p>
<p><img src="https://www.freeimg.cn/i/2024/05/13/6641b5ba591ae.jpg" alt="https://www.freeimg.cn/i/2024/05/13/6641b5ba591ae.jpg"></p>
<p>总结一句话：<strong>容器的持久化和同步操作！容器之间的数据也是可以共享的</strong></p>
<h3 id="6-2使用数据卷"><a href="#6-2使用数据卷" class="headerlink" title="6.2使用数据卷"></a>6.2使用数据卷</h3><blockquote>
<p>方式一：直接使用命令   -v  </p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -v 主机目录:容器目录</span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng home]# docker run -it -v /home/ceshi:/home tomcat /bin/bash</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动起来之后，可以通过docker inspect 容器<span class="built_in">id</span>   查看容器的元数据，可以找到下方的挂载</span></span><br><span class="line"></span><br><span class="line">&quot;Mounts&quot;: [</span><br><span class="line">          &#123;</span><br><span class="line">              &quot;Type&quot;: &quot;bind&quot;,</span><br><span class="line">              &quot;Source&quot;: &quot;/home/ceshi&quot;,    #主机内的目录</span><br><span class="line">              &quot;Destination&quot;: &quot;/home&quot;,		#容器内的目录</span><br><span class="line">              &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">              &quot;RW&quot;: true,</span><br><span class="line">              &quot;Propagation&quot;: &quot;rprivate&quot;</span><br><span class="line">          &#125;</span><br><span class="line">      ],</span><br></pre></td></tr></table></figure>

<h3 id="6-3实战：部署Mysql"><a href="#6-3实战：部署Mysql" class="headerlink" title="6.3实战：部署Mysql"></a>6.3实战：部署Mysql</h3><p>思考：mysql的数据持久化问题</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng /]# docker run -d -p 3307:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=Mypasseord --name mysql01 mysql</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">挂机到本地</span></span><br></pre></td></tr></table></figure>

<h3 id="6-4具名和匿名挂载"><a href="#6-4具名和匿名挂载" class="headerlink" title="6.4具名和匿名挂载"></a>6.4具名和匿名挂载</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">匿名挂载</span></span><br><span class="line">-v  容器内路径</span><br><span class="line">docker run -d -P --name nginx01 -v /etc/nginx  nginx</span><br><span class="line"></span><br><span class="line">[root@wpeng data]# docker volume --help</span><br><span class="line">Usage:  docker volume COMMAND</span><br><span class="line">Manage volumes</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  create      Create a volume</span><br><span class="line">  inspect     Display detailed information on one or more volumes</span><br><span class="line">  ls          List volumes</span><br><span class="line">  prune       Remove unused local volumes</span><br><span class="line">  rm          Remove one or more volumes</span><br><span class="line"></span><br><span class="line">Run &#x27;docker volume COMMAND --help&#x27; for more information on a command.</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看所有卷的情况</span></span><br><span class="line">[root@wpeng data]# docker volume ls</span><br><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     09ed66408d0ea4f3cede2deb02050a0bada25b157888fcda3f1166fea9270c8b</span><br><span class="line">local     36c362bddff71830d36d3a6c32aee9b7a8c8f486d1bcc33e0281e77c9b22b579</span><br><span class="line">local     125b1bde7fa779c129b710c6b2a3d5295c6e1073bad17a53fe1484355d19022e</span><br><span class="line">local     03027f475b79a21b49b0ca7c6950f333151c6cc1f35f0f1735b4d2572ef9ae08</span><br><span class="line">local     959225beaef8d8194aed30d2c96ecb1199b73f5be6e2cd9547d3696ecf90f13b</span><br><span class="line">local     b7016e08f4d6e6cd186815c6778a7831be7e43ba48ea9f0eb370bb756388ee6c</span><br><span class="line">local     ccf907023afe4669577ce46e75b403bbe30f8ed3fdb53e7be3c22e0de57a8680</span><br><span class="line">local     d7b8b4150ebc6d374d39ac8d35e2f598cafd7b8bdb2c44a3f77e3cef09537df1</span><br><span class="line">local     dbb2225560dd9c26105084169118989d03176d98fcc0490246155d820950c684</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>具名挂载</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx</span><br></pre></td></tr></table></figure>

<p><strong>区别</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">如何确定是具名挂载还是匿名挂载，还是指定路径挂载</span></span><br><span class="line">-v  容器内路径    	#匿名挂载</span><br><span class="line">-v  卷名:容器内路径  #具名挂载</span><br><span class="line">-v  /宿主机路径:容器内路径 #指定路径挂载</span><br></pre></td></tr></table></figure>

<p>拓展：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">通过 -v 容器内路径:ro rw 改变读写权限</span></span><br><span class="line">ro   readonly    #只读</span><br><span class="line">rw	 readwrite	 #读写</span><br><span class="line">docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:ro rw nginx</span><br><span class="line">docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:ro rw nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ro 只要看到ro就说明这个路径只能通过宿主机来操作，容器内是无法操作的</span></span><br></pre></td></tr></table></figure>

<h3 id="6-5初始Dockerfile"><a href="#6-5初始Dockerfile" class="headerlink" title="6.5初始Dockerfile"></a>6.5初始Dockerfile</h3><p>dockerfile就是用来构建docker镜像的构建文件！命令脚本</p>
<p>通过这个脚本可以生成一个镜像，镜像是一层一层的，脚本是一个一个命令  每个命令都是一层</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FROM centos</span><br><span class="line"></span><br><span class="line">VOLUME [&quot;volume01&quot;,&quot;volume02&quot;]</span><br><span class="line"></span><br><span class="line">CMD echo &quot;-----end-----&quot;</span><br><span class="line"></span><br><span class="line">CMD /bin/bash</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">上述的命令，就是镜像的一层</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>构建镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -f /home/docker-test-volume/dockerfile -t wpeng/centos:1.0 .</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;复制粘贴时，小心细节，结尾一定要加空格再加点&#x3D;&#x3D;。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动自己生成的容器</span></span><br><span class="line">[root@wpeng ~]# docker run -it 9b5949716ba8 /bin/bash</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">使用<span class="built_in">ls</span>命令，查看目录发现两个挂载的目录</span></span><br><span class="line">drwxr-xr-x   2 root root 4096 May 14 02:38 volume01</span><br><span class="line">drwxr-xr-x   2 root root 4096 May 14 02:38 volume02</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;发现了这两个卷，说明外部一定有同步的目录&#x3D;&#x3D;</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">使用inspect命令查看镜像元数据</span></span><br><span class="line">docker inspect 容器id</span><br></pre></td></tr></table></figure>

<p><img src="https://www.freeimg.cn/i/2024/05/14/6642d5b191c27.png" alt="https://www.freeimg.cn/i/2024/05/14/6642d5b191c27.png"></p>
<p><strong>在mounts下可以找到容器内挂载目录在宿主机上对应的目录，就是source目录</strong></p>
<p>在宿主机下找到这个目录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng /]# cd /var/lib/docker/volumes/d4a1b49ca6e2b10dde089f27d7ef5459b5b7e03aed4f42fbbea05961131f22e5/_data</span><br><span class="line">[root@wpeng _data]# ls</span><br><span class="line">container.txt</span><br></pre></td></tr></table></figure>

<p>可以看到该目录下有一个container.txt</p>
<h3 id="6-6数据卷容器"><a href="#6-6数据卷容器" class="headerlink" title="6.6数据卷容器"></a>6.6数据卷容器</h3><p><strong>多个mysql同步数据</strong></p>
<p><img src="https://www.freeimg.cn/i/2024/05/13/66422773b10ff.jpg" alt="https://www.freeimg.cn/i/2024/05/13/66422773b10ff.jpg"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">先启动一个容器</span></span><br><span class="line">[root@wpeng /]# docker run -it --name docker01 wpeng/centos:1.0 </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">再启动一个容器，父容器是docker01</span></span><br><span class="line">[root@wpeng /]# docker run -it --name docker02 --volumes-from docker01 wpeng/centos:1.0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在docker01容器中创建一个container.txt</span></span><br><span class="line">[root@wpeng ~]# docker exec -it 1440424683e5 /bin/bash</span><br><span class="line">[root@1440424683e5 /]# ls    </span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var  volume01	volume02</span><br><span class="line">[root@1440424683e5 /]# cd volume01</span><br><span class="line">[root@1440424683e5 volume01]# ls</span><br><span class="line">[root@1440424683e5 volume01]# touch container.txt</span><br><span class="line">[root@1440424683e5 volume01]# ls</span><br><span class="line">container.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">发现在docker02容器中也发现了container.txt</span></span><br><span class="line">[root@wpeng ~]# docker run -it --name docker02 --volumes-from docker01 9b5949716ba8</span><br><span class="line">[root@cc09ccf13df0 /]# ls</span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var  volume01	volume02</span><br><span class="line">[root@cc09ccf13df0 /]# cd volume01</span><br><span class="line">[root@cc09ccf13df0 volume01]# ls</span><br><span class="line">container.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;上述容器docker02依赖于docker01，执行删除docker01容器之后，docker02里面的数据还是存在的，实现了共享与备份&#x3D;&#x3D;</p>
<p><strong>多个mysql实现数据共享</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng /]# docker run -d -p 3307:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=Mypassword --name mysql01 mysql</span><br><span class="line"></span><br><span class="line">[root@wpeng /]# docker run -d -p 3308:3306  -e MYSQL_ROOT_PASSWORD=Mypassword --name mysql02 --volumes -from mysql01 mysql </span><br></pre></td></tr></table></figure>

<p><strong>结论</strong></p>
<p>容器之间配置信息的传递，数据卷容器的生命周期一直持续到没有容器使用为止</p>
<p>但是你一旦持久化到本地，这个时候，本地的数据是不会删除的</p>
<h2 id="7-DockerFile"><a href="#7-DockerFile" class="headerlink" title="7.DockerFile"></a>7.DockerFile</h2><h3 id="7-1DockerFile介绍"><a href="#7-1DockerFile介绍" class="headerlink" title="7.1DockerFile介绍"></a>7.1DockerFile介绍</h3><p><strong>dockerfile是用来构建docker镜像的文件，就是命令参数脚本</strong></p>
<p>很多官方镜像都是基础包，很多功能没有，我们通常会搭建自己的镜像</p>
<p>构建步骤：</p>
<ol>
<li>编写一个dockerfile文件</li>
<li>docker build 一个镜像</li>
<li>docker run 运行镜像</li>
<li>通过docker push 发布镜像（DockerHub，阿里云镜像仓库）</li>
</ol>
<h3 id="7-2DockerFile构建过程"><a href="#7-2DockerFile构建过程" class="headerlink" title="7.2DockerFile构建过程"></a>7.2DockerFile构建过程</h3><p><strong>基础知识</strong></p>
<ol>
<li>每个保留关键字（指令）都必须是大写字母</li>
<li>执行从上到下顺序执行</li>
<li>#表示注释</li>
<li>每一个指令都会创建提交一个新的镜像层，并提交<img src="https://www.freeimg.cn/i/2024/05/14/66433726dd7a8.jpg" alt="https://www.freeimg.cn/i/2024/05/14/66433726dd7a8.jpg"></li>
</ol>
<p>dockerfile是面向开发的，我们以后要发布项目，就需要编写dockerfile文件，这个文件是十分简单</p>
<p>DockerFile：构建文件。定义了一切的步骤，源代码</p>
<p>DockerImages：通过DockeFile构建生成的镜像，最终发布和运行的产品</p>
<p>Docker容器：容器就是为镜像运行起来提供服务的</p>
<h3 id="7-3DockerFile的指令"><a href="#7-3DockerFile的指令" class="headerlink" title="7.3DockerFile的指令"></a>7.3DockerFile的指令</h3><p><img src="https://www.freeimg.cn/i/2024/05/14/664339d6b8a72.png" alt="https://www.freeimg.cn/i/2024/05/14/664339d6b8a72.png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">FROM		#基础镜像，一切从这里构建</span><br><span class="line">MAINTAINER  #镜像的作者，一般姓名+邮箱</span><br><span class="line">RUN			#镜像构建的时候需要运行的命令</span><br><span class="line">ADD			#步骤：如果需要添加tomcat镜像，则需要tomcat压缩包！添加内容</span><br><span class="line">WORKDIR		#镜像的工作目录  </span><br><span class="line">VOLUME		#挂载的目录位置</span><br><span class="line">EXPOSE		#暴露端口配置   和-p是一个作用，如果expose了就不需要-p暴露端口了</span><br><span class="line">CMD			#指定这个容器启动的时候要运行的命令，只有最后一个会生效，可被替代</span><br><span class="line">ENTRYPOINT  #指定这个容器启动的时候要运行的命令，可以直接追加命令</span><br><span class="line">ONBUILD     #当构建一个被继承DockerFile，这个时候就会运行ONBUILD的指令，触发指令</span><br><span class="line">COPY		#类似于ADD命令，将我们的文件拷贝到镜像中</span><br><span class="line">ENV			#构建的时候设置环境变量</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;CMD和ENTRYPOINT的区别&#x3D;&#x3D;</p>
<p><strong>CMD</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动的时候会列出列表</span></span><br><span class="line">[root@wpeng dockerfile]# cat dockerfile-test-cmd </span><br><span class="line">FROM  centos</span><br><span class="line">CMD [&quot;ls&quot;,&quot;-a&quot;]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">构建镜像</span></span><br><span class="line">[root@wpeng dockerfile]# docker build -f dockerfile-test-cmd -t cmdtest .</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">运行，可以看到运行结果直接列出目录，run的时候会执行<span class="built_in">ls</span> -a命令</span></span><br><span class="line">[root@wpeng dockerfile]# docker run cmdtest</span><br><span class="line">.</span><br><span class="line">..</span><br><span class="line">.dockerenv</span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">lost+found</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">root</span><br><span class="line">run</span><br><span class="line">sbin</span><br><span class="line">srv</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">想追加一个命令-l    执行<span class="built_in">ls</span> -al命令</span></span><br><span class="line">[root@wpeng dockerfile]# docker run cmdtest -l</span><br><span class="line">docker: Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: exec: &quot;-l&quot;: executable file not found in $PATH: unknown.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">cmd的情况下  -l替换了CMD[<span class="string">&quot;ls&quot;</span>,<span class="string">&quot;-a&quot;</span>]命令，但是-l不是命令，所以报错</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">想解决错误，只能[root@wpeng dockerfile]<span class="comment"># docker run cmdtest ls -al</span></span></span><br></pre></td></tr></table></figure>

<p><strong>ENTRYPOINT</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动的时候会出现列表</span></span><br><span class="line">[root@wpeng dockerfile]# cat dockerfile-cmd-entrypoint </span><br><span class="line">FROM centos</span><br><span class="line">ENTRYPOINT [&quot;ls&quot;,&quot;-a&quot;]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">构建镜像</span></span><br><span class="line">[root@wpeng dockerfile]# docker build -f dockerfile-cmd-entrypoint -t entrypoint-test .</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">附加-l参数启动容器，我们的追加命令直接拼接在ENTRYPOINT命令的后面</span></span><br><span class="line">[root@wpeng dockerfile]# docker run entrypoint-test -l</span><br><span class="line">total 56</span><br><span class="line">drwxr-xr-x   1 root root 4096 May 15 02:59 .</span><br><span class="line">drwxr-xr-x   1 root root 4096 May 15 02:59 ..</span><br><span class="line">-rwxr-xr-x   1 root root    0 May 15 02:59 .dockerenv</span><br><span class="line">lrwxrwxrwx   1 root root    7 Nov  3  2020 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x   5 root root  340 May 15 02:59 dev</span><br><span class="line">drwxr-xr-x   1 root root 4096 May 15 02:59 etc</span><br><span class="line">drwxr-xr-x   2 root root 4096 Nov  3  2020 home</span><br><span class="line">lrwxrwxrwx   1 root root    7 Nov  3  2020 lib -&gt; usr/lib</span><br><span class="line">lrwxrwxrwx   1 root root    9 Nov  3  2020 lib64 -&gt; usr/lib64</span><br><span class="line">drwx------   2 root root 4096 Sep 15  2021 lost+found</span><br><span class="line">drwxr-xr-x   2 root root 4096 Nov  3  2020 media</span><br><span class="line">drwxr-xr-x   2 root root 4096 Nov  3  2020 mnt</span><br><span class="line">drwxr-xr-x   2 root root 4096 Nov  3  2020 opt</span><br><span class="line">dr-xr-xr-x 231 root root    0 May 15 02:59 proc</span><br><span class="line">dr-xr-x---   2 root root 4096 Sep 15  2021 root</span><br><span class="line">drwxr-xr-x  11 root root 4096 Sep 15  2021 run</span><br><span class="line">lrwxrwxrwx   1 root root    8 Nov  3  2020 sbin -&gt; usr/sbin</span><br><span class="line">drwxr-xr-x   2 root root 4096 Nov  3  2020 srv</span><br><span class="line">dr-xr-xr-x  13 root root    0 May 15 02:59 sys</span><br><span class="line">drwxrwxrwt   7 root root 4096 Sep 15  2021 tmp</span><br><span class="line">drwxr-xr-x  12 root root 4096 Sep 15  2021 usr</span><br><span class="line">drwxr-xr-x  20 root root 4096 Sep 15  2021 var</span><br></pre></td></tr></table></figure>

<h3 id="7-4实战测试"><a href="#7-4实战测试" class="headerlink" title="7.4实战测试"></a>7.4实战测试</h3><p>DockerHub中百分99的镜像都是从这个基础镜像过来的  FROM scratch，然后配置需要的软件和配置来进行构建</p>
<p><img src="https://www.freeimg.cn/i/2024/05/14/66434f85cbc40.png" alt="https://www.freeimg.cn/i/2024/05/14/66434f85cbc40.png"></p>
<p><strong>创建一个自己的centos</strong></p>
<p>1.编写dockerfile的编写文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng home]# cd dockerfile </span><br><span class="line">[root@wpeng dockerfile]# ls</span><br><span class="line">[root@wpeng dockerfile]# vim wpengdockerfile</span><br><span class="line"></span><br><span class="line">[root@wpeng dockerfile]# cat wpengdockerfile </span><br><span class="line">FROM centos</span><br><span class="line">MAINTAINER wpeng&lt;2119026961@qq.com&gt;</span><br><span class="line"></span><br><span class="line">ENV MYPATH /usr/local</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"></span><br><span class="line">RUN yum -y install vim</span><br><span class="line">RUN yum -y install net-tools</span><br><span class="line"></span><br><span class="line">EXPOSE 8090</span><br><span class="line"></span><br><span class="line">CMD echo $MYPATH</span><br><span class="line">CMD echo &quot;----end-----&quot;</span><br><span class="line">CMD /bin/bash</span><br></pre></td></tr></table></figure>

<p>2.通过这个文件构建镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng dockerfile]# docker build -f wpengdockerfile -t mycentos:0.1 .</span><br><span class="line">[+] Building 14.9s (9/9) FINISHED                                                                                          docker:default</span><br><span class="line"> =&gt; [internal] load build definition from wpengdockerfile                                                                            0.0s</span><br><span class="line"> =&gt; =&gt; transferring dockerfile: 473B                                                                                                 0.0s</span><br><span class="line"> =&gt; [internal] load metadata for docker.io/library/centos:latest                                                                     0.0s</span><br><span class="line"> =&gt; [internal] load .dockerignore                                                                                                    0.0s</span><br><span class="line"> =&gt; =&gt; transferring context: 2B                                                                                                      0.0s</span><br><span class="line"> =&gt; [1/5] FROM docker.io/library/centos:latest                                                                                       0.0s</span><br><span class="line"> =&gt; CACHED [2/5] WORKDIR /usr/local                                                                                                  0.0s</span><br><span class="line"> =&gt; [3/5] RUN sed -i &#x27;s|^mirrorlist=|#mirrorlist=|g&#x27; /etc/yum.repos.d/CentOS-*.repo     &amp;&amp; sed -i &#x27;s|^#baseurl=http://mirror.centos  5.5s</span><br><span class="line"> =&gt; [4/5] RUN yum -y install vim                                                                                                     6.2s </span><br><span class="line"> =&gt; [5/5] RUN yum -y install net-tools                                                                                               2.1s </span><br><span class="line"> =&gt; exporting to image                                                                                                               1.1s </span><br><span class="line"> =&gt; =&gt; exporting layers                                                                                                              1.0s </span><br><span class="line"> =&gt; =&gt; writing image sha256:bb179add7bd4004d7112989dba95ddc1a361713854f6839a01d636acc36c060e                                         0.0s </span><br><span class="line"> =&gt; =&gt; naming to docker.io/library/mycentos:0.1 </span><br></pre></td></tr></table></figure>

<p>3.测试运行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng dockerfile]# docker run -it mycentos:0.1</span><br><span class="line">[root@11b0db9ce40c local]# pwd </span><br><span class="line">/usr/local</span><br><span class="line">[root@11b0db9ce40c local]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.10  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line">        ether 02:42:ac:11:00:0a  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 14  bytes 1181 (1.1 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">[root@11b0db9ce40c local]# vim test</span><br><span class="line">[root@11b0db9ce40c local]# ls</span><br><span class="line">bin  etc  games  include  lib  lib64  libexec  sbin  share  src  test</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">官方原生的</span></span><br><span class="line">pwd是根目录，我们这里配置了工作目录 /usr/local</span><br><span class="line">官方没有vim命令，我们配置的镜像会有vim命令</span><br></pre></td></tr></table></figure>

<p>我们可以列出本地镜像的变更历史</p>
<p>docker histtory 镜像名或者id</p>
<h3 id="7-5制作Tomcat镜像"><a href="#7-5制作Tomcat镜像" class="headerlink" title="7.5制作Tomcat镜像"></a>7.5制作Tomcat镜像</h3><p>1.准备镜像文件tomcat压缩包，jdk的压缩包！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng ~]# cd /home</span><br><span class="line">[root@wpeng home]# ls</span><br><span class="line">Mytest  ceshi  docker-test-volume  dockerfile  mysql  test.java  wpeng</span><br><span class="line">[root@wpeng home]# cd wpeng/</span><br><span class="line">[root@wpeng wpeng]# ls</span><br><span class="line">apache-tomcat-9.0.87  apache-tomcat-9.0.87.tar.gz  jdk-8u202-linux-x64.tar.gz  jdk1.8.0_202</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2.编写dockerfile文件，官方命名：Dockerfile，build的时候会自动寻找这个文件，就不需要-f指定了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng wpeng]# vim Dockerfile</span><br><span class="line"></span><br><span class="line">FROM centos: 7</span><br><span class="line">MAINTAINER wpeng&lt;2119026961@qq.com&gt;</span><br><span class="line"></span><br><span class="line">ADD jdk-8u202-linux-x64.tar.gz /usr/local/</span><br><span class="line">ADD apache-tomcat-9.0.87.tar.gz /usr/local/</span><br><span class="line"></span><br><span class="line">RUN yum -y install vim</span><br><span class="line"></span><br><span class="line">ENV MYPATH /usr/local</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"></span><br><span class="line">ENV JAVA_HOME /usr/local/jdk1.8.0_11</span><br><span class="line">ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line"></span><br><span class="line">ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.87</span><br><span class="line">ENV CATALINA_BASH /usr/local/apache-tomcat-9.0.87</span><br><span class="line">ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin</span><br><span class="line"></span><br><span class="line">EXPOSE 8091</span><br><span class="line"></span><br><span class="line">CMD /usr/local/apache-tomcat-9.0.87/startup.sh &amp;&amp; tail -F /usr/local/apache-tomcat-9.0.87/bin/logs/catalina.out</span><br></pre></td></tr></table></figure>

<p>3.构建镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng wpeng]# docker build -t diytomcat .</span><br><span class="line">[+] Building 0.0s (1/1) FINISHED                                                                                           docker:default</span><br><span class="line"> =&gt; [internal] load build definition from Dockerfile                                                                                 0.0s</span><br><span class="line"> =&gt; =&gt; transferring dockerfile: 635B                                                                                                 0.0s</span><br><span class="line">Dockerfile:1</span><br><span class="line">--------------------</span><br><span class="line">   1 | &gt;&gt;&gt; FROM centos: 7</span><br><span class="line">   2 |     MAINTAINER wpeng&lt;2119026961@qq.com&gt;</span><br><span class="line">   3 |     </span><br><span class="line">--------------------</span><br><span class="line">ERROR: failed to solve: dockerfile parse error on line 1: FROM requires either one or three arguments</span><br><span class="line">[root@wpeng wpeng]# vim dockerfile</span><br><span class="line">[root@wpeng wpeng]# vim Dockerfile </span><br><span class="line">[root@wpeng wpeng]# docker build -t diytomcat .</span><br><span class="line">[+] Building 51.7s (10/10) FINISHED                                                                                        docker:default</span><br><span class="line"> =&gt; [internal] load build definition from Dockerfile                                                                                 0.0s</span><br><span class="line"> =&gt; =&gt; transferring dockerfile: 634B                                                                                                 0.0s</span><br><span class="line"> =&gt; [internal] load metadata for docker.io/library/centos:7                                                                          3.7s</span><br><span class="line"> =&gt; [internal] load .dockerignore                                                                                                    0.0s</span><br><span class="line"> =&gt; =&gt; transferring context: 2B                                                                                                      0.0s</span><br><span class="line"> =&gt; [1/5] FROM docker.io/library/centos:7@sha256:be65f488b7764ad3638f236b7b515b3678369a5124c47b8d32916d6487418ea4                   22.1s</span><br><span class="line"> =&gt; =&gt; resolve docker.io/library/centos:7@sha256:be65f488b7764ad3638f236b7b515b3678369a5124c47b8d32916d6487418ea4                    0.0s</span><br><span class="line"> =&gt; =&gt; sha256:be65f488b7764ad3638f236b7b515b3678369a5124c47b8d32916d6487418ea4 1.20kB / 1.20kB                                       0.0s</span><br><span class="line"> =&gt; =&gt; sha256:dead07b4d8ed7e29e98de0f4504d87e8880d4347859d839686a31da35a3b532f 529B / 529B                                           0.0s</span><br><span class="line"> =&gt; =&gt; sha256:eeb6ee3f44bd0b5103bb561b4c16bcb82328cfe5809ab675bb17ab3a16c517c9 2.75kB / 2.75kB                                       0.0s</span><br><span class="line"> =&gt; =&gt; sha256:2d473b07cdd5f0912cd6f1a703352c82b512407db6b05b43f2553732b55df3bc 76.10MB / 76.10MB                                    18.3s</span><br><span class="line"> =&gt; =&gt; extracting sha256:2d473b07cdd5f0912cd6f1a703352c82b512407db6b05b43f2553732b55df3bc                                            3.4s</span><br><span class="line"> =&gt; [internal] load build context                                                                                                    1.6s</span><br><span class="line"> =&gt; =&gt; transferring context: 205.84MB                                                                                                1.6s</span><br><span class="line"> =&gt; [2/5] ADD jdk-8u202-linux-x64.tar.gz /usr/local/                                                                                 4.4s</span><br><span class="line"> =&gt; [3/5] ADD apache-tomcat-9.0.87.tar.gz /usr/local/                                                                                0.4s</span><br><span class="line"> =&gt; [4/5] RUN yum -y install vim                                                                                                    17.7s</span><br><span class="line"> =&gt; [5/5] WORKDIR /usr/local                                                                                                         0.0s </span><br><span class="line"> =&gt; exporting to image                                                                                                               3.2s </span><br><span class="line"> =&gt; =&gt; exporting layers                                                                                                              3.2s </span><br><span class="line"> =&gt; =&gt; writing image sha256:70cec7e14015b6051ea93fc15d530151d092682565790deb41fb464e65c044cc                                         0.0s </span><br><span class="line"> =&gt; =&gt; naming to docker.io/library/diytomcat   </span><br></pre></td></tr></table></figure>

<h3 id="7-6发布自己的镜像"><a href="#7-6发布自己的镜像" class="headerlink" title="7.6发布自己的镜像"></a>7.6发布自己的镜像</h3><p><strong>发布镜像到dockerhub上</strong></p>
<p>1.登录到dockerhub上</p>
<p>2.在我们的服务器上提交自己的镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng ~]# docker login --help</span><br><span class="line"></span><br><span class="line">Usage:  docker login [OPTIONS] [SERVER]</span><br><span class="line"></span><br><span class="line">Log in to a registry.</span><br><span class="line">If no server is specified, the default is defined by the daemon.</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -p, --password string   Password</span><br><span class="line">      --password-stdin    Take the password from stdin</span><br><span class="line">  -u, --username string   Username</span><br></pre></td></tr></table></figure>

<p>3.登录完毕后就可以提交镜像了，就是一步docker push</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1.项目创建完成后，返回控制台，列出所有镜像</span></span><br><span class="line">docker images</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2、将要发布的镜像修改标记，标记为自己账号下。此处我的项目名：yuki03233</span></span><br><span class="line">docker tag consul yuki03233/consul</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">3、发布镜像</span></span><br><span class="line">docker push yuki03233/consul</span><br></pre></td></tr></table></figure>

<p><strong>发布镜像到阿里云服务器上</strong></p>
<p>1.登录阿里云，找到镜像服务</p>
<p>2.创建命名空键7</p>
<p>3.创建容器镜像</p>
<h2 id="8-Docker网络"><a href="#8-Docker网络" class="headerlink" title="8.Docker网络"></a>8.Docker网络</h2><h3 id="8-1-理解docker0"><a href="#8-1-理解docker0" class="headerlink" title="8.1 理解docker0"></a>8.1 理解docker0</h3><p>三个网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">docker 是如何处理容器网络访问的</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看容器的内部网络地址  ip addr</span></span><br><span class="line"></span><br><span class="line">docker inspect container-id  #审查容器</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">linux可以ping通docker容器内部</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>原理</strong></p>
<ol>
<li><p>我们每启动一个docker容器，docker就会给docker容器分配一个ip，我们只要安装了docker，就会有一个网卡docker0，        桥接模式，使用的技术是evth-pair技术</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">我们发现这个容器带来网卡，都是一对对的</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">evth-pair 就是一对的虚拟设备接口，他们都是成对出现的，一段连着协议，一段彼此相连</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">正是因为有这个特性，evth-pair充当一个桥梁，连接各种虚拟网络设备</span> </span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="8-2-自定义网络"><a href="#8-2-自定义网络" class="headerlink" title="8.2 自定义网络"></a>8.2 自定义网络</h3><p>查看所有的docker网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network ls</span><br></pre></td></tr></table></figure>

<p><strong>网络模式</strong></p>
<p>bridge：桥接 docker （默认，使用veth技术）</p>
<p>none：不配置网络</p>
<p>host：主机模式，和宿主机共享网络</p>
<p>container：容器网络联通（用的少，局限性很大</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建网络</span></span><br><span class="line">[root@wpeng /]# docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet</span><br><span class="line">b23f86d94b2f50d050aed77f82d62ad94d537f86c4f0399606b66ab8c2807868</span><br><span class="line">[root@wpeng /]# docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">c539b81d49ac   bridge    bridge    local</span><br><span class="line">06e90eab0aaf   host      host      local</span><br><span class="line">b23f86d94b2f   mynet     bridge    local</span><br><span class="line">6cd224f00fba   none      null      local</span><br><span class="line">05af1142be47   zk        bridge    local</span><br></pre></td></tr></table></figure>

<p>检查自己的网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@wpeng /]# docker network inspect mynet</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Name&quot;: &quot;mynet&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;b23f86d94b2f50d050aed77f82d62ad94d537f86c4f0399606b66ab8c2807868&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2024-06-18T23:26:12.7419496+08:00&quot;,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">        &quot;EnableIPv6&quot;: false,</span><br><span class="line">        &quot;IPAM&quot;: &#123;</span><br><span class="line">            &quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">            &quot;Config&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Subnet&quot;: &quot;192.168.0.0/16&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;192.168.0.1&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Internal&quot;: false,</span><br><span class="line">        &quot;Attachable&quot;: false,</span><br><span class="line">        &quot;Ingress&quot;: false,</span><br><span class="line">        &quot;ConfigFrom&quot;: &#123;</span><br><span class="line">            &quot;Network&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ConfigOnly&quot;: false,</span><br><span class="line">        &quot;Containers&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="8-3-网络联通"><a href="#8-3-网络联通" class="headerlink" title="8.3 网络联通"></a>8.3 网络联通</h3>
    </div>

    
    
    <div class="post-widgets">
      <div id="needsharebutton-postbottom">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    </div>

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Docker/" rel="tag"># Docker</a>
              <a href="/tags/DeployTools/" rel="tag"># DeployTools</a>
              <a href="/tags/DevelopTools/" rel="tag"># DevelopTools</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/06/30/Linux/" rel="prev" title="Linux">
      <i class="fa fa-chevron-left"></i> Linux
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/07/01/SpringBoot/" rel="next" title="Springboot">
      Springboot <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker"><span class="nav-number">1.</span> <span class="nav-text">Docker</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Docker%E6%A6%82%E8%BF%B0"><span class="nav-number">1.1.</span> <span class="nav-text">1.Docker概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1Docker%E8%83%BD%E5%81%9A%E4%BB%80%E4%B9%88"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.1Docker能做什么</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2Docker%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.2Docker基本组成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3%E5%9B%9E%E9%A1%BEDocker-helloworld%E6%B5%81%E7%A8%8B"><span class="nav-number">1.1.3.</span> <span class="nav-text">1.3回顾Docker helloworld流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="nav-number">1.1.4.</span> <span class="nav-text">1.4底层原理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Docker%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.</span> <span class="nav-text">2.Docker的基本命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1%E5%B8%AE%E5%8A%A9%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.1.</span> <span class="nav-text">2.1帮助命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E9%95%9C%E5%83%8F%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.2.</span> <span class="nav-text">2.2 镜像命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.3.</span> <span class="nav-text">2.3 容器命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4%E5%B8%B8%E7%94%A8%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.4.</span> <span class="nav-text">2.4常用其他命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E4%BD%9C%E4%B8%9A%E7%BB%83%E4%B9%A0"><span class="nav-number">1.3.</span> <span class="nav-text">3.作业练习</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="nav-number">1.4.</span> <span class="nav-text">4.可视化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1portainer"><span class="nav-number">1.4.1.</span> <span class="nav-text">4.1portainer</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-Docker%E9%95%9C%E5%83%8F%E8%AE%B2%E8%A7%A3"><span class="nav-number">1.5.</span> <span class="nav-text">5.Docker镜像讲解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1%E9%95%9C%E5%83%8F%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-number">1.5.1.</span> <span class="nav-text">5.1镜像是什么</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2Docker%E9%95%9C%E5%83%8F%E5%8A%A0%E8%BD%BD%E5%8E%9F%E7%90%86"><span class="nav-number">1.5.2.</span> <span class="nav-text">5.2Docker镜像加载原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3%E5%88%86%E5%B1%82%E7%90%86%E8%A7%A3"><span class="nav-number">1.5.3.</span> <span class="nav-text">5.3分层理解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-4-commit%E9%95%9C%E5%83%8F"><span class="nav-number">1.5.4.</span> <span class="nav-text">5.4  commit镜像</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">1.6.</span> <span class="nav-text">6.容器数据卷</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">1.6.1.</span> <span class="nav-text">6.1什么是容器数据卷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">1.6.2.</span> <span class="nav-text">6.2使用数据卷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3%E5%AE%9E%E6%88%98%EF%BC%9A%E9%83%A8%E7%BD%B2Mysql"><span class="nav-number">1.6.3.</span> <span class="nav-text">6.3实战：部署Mysql</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-4%E5%85%B7%E5%90%8D%E5%92%8C%E5%8C%BF%E5%90%8D%E6%8C%82%E8%BD%BD"><span class="nav-number">1.6.4.</span> <span class="nav-text">6.4具名和匿名挂载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-5%E5%88%9D%E5%A7%8BDockerfile"><span class="nav-number">1.6.5.</span> <span class="nav-text">6.5初始Dockerfile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-6%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%AE%B9%E5%99%A8"><span class="nav-number">1.6.6.</span> <span class="nav-text">6.6数据卷容器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-DockerFile"><span class="nav-number">1.7.</span> <span class="nav-text">7.DockerFile</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1DockerFile%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.7.1.</span> <span class="nav-text">7.1DockerFile介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2DockerFile%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="nav-number">1.7.2.</span> <span class="nav-text">7.2DockerFile构建过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-3DockerFile%E7%9A%84%E6%8C%87%E4%BB%A4"><span class="nav-number">1.7.3.</span> <span class="nav-text">7.3DockerFile的指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-4%E5%AE%9E%E6%88%98%E6%B5%8B%E8%AF%95"><span class="nav-number">1.7.4.</span> <span class="nav-text">7.4实战测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-5%E5%88%B6%E4%BD%9CTomcat%E9%95%9C%E5%83%8F"><span class="nav-number">1.7.5.</span> <span class="nav-text">7.5制作Tomcat镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-6%E5%8F%91%E5%B8%83%E8%87%AA%E5%B7%B1%E7%9A%84%E9%95%9C%E5%83%8F"><span class="nav-number">1.7.6.</span> <span class="nav-text">7.6发布自己的镜像</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-Docker%E7%BD%91%E7%BB%9C"><span class="nav-number">1.8.</span> <span class="nav-text">8.Docker网络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-%E7%90%86%E8%A7%A3docker0"><span class="nav-number">1.8.1.</span> <span class="nav-text">8.1 理解docker0</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C"><span class="nav-number">1.8.2.</span> <span class="nav-text">8.2 自定义网络</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-%E7%BD%91%E7%BB%9C%E8%81%94%E9%80%9A"><span class="nav-number">1.8.3.</span> <span class="nav-text">8.3 网络联通</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Peng"
      src="/images/myavatar.jpg">
  <p class="site-author-name" itemprop="name">Peng</p>
  <div class="site-description" itemprop="description"><font color="#FFFFFF">Done is better than perfect</font></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">9</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/wpeng2005" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;wpeng2005" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/2303_76216371" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;2303_76216371" rel="noopener" target="_blank"><i class="crosshairs fa-fw"></i>CSDN</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:w2119026961@gmail.com" title="E-Mail → mailto:w2119026961@gmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>
      
    </div>
  
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fab fa-github"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">peng</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script>
  <script>
      pbOptions = {};
        pbOptions.iconStyle = "box";
        pbOptions.boxForm = "horizontal";
        pbOptions.position = "bottomCenter";
        pbOptions.networks = "Wechat,QQZone,Weibo,Douban,Twitter,Facebook";
      new needShareButton('#needsharebutton-postbottom', pbOptions);
  </script>

  
</body>
</html>
